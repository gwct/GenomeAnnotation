from glob import glob
from os.path import basename
import yaml
from os import system

configfile: "/n/home_rc/afreedman/workspace/GenomeAnnotation/Snakemake/config.yaml"
res_config = yaml.load(open("/n/home_rc/afreedman/workspace/GenomeAnnotation/Snakemake/config/resources.yaml"),Loader=yaml.FullLoader)


## setup tmp directory for samtools sort ##
if glob("tmp") == ['tmp']:
    pass
elif glob("tmp") == []: 
    system("mkdir tmp")
else:
   print("Error generating tmp dir for samsort")

if glob("%s" % config["samsortOutdir"]) == [config["samsortOutdir"]]:
    pass
elif glob("%s" % config["samsortOutdir"]) == []:
    system("mkdir %s" % config["samsortOutdir"])
else:
    print("Error generating destination dir for sorted bams")
    
###
    
SAMPLES = list(set([basename(i.split('/')[-1].split('_')[0]) for i in glob("%s*gz" % config["fastqDir"])]))

### RULES ###

rule all:
    input:
        expand("{outdir}sorted_{sample}_hisat2.bam", outdir=config["samsortOutdir"],sample=SAMPLES)


include: "/n/home_rc/afreedman/workspace/GenomeAnnotation/Snakemake/rules/hisat2.smk"
