from glob import glob
from os.path import basename
import yaml
from os import system

configfile: "/n/home_rc/afreedman/workspace/GenomeAnnotation/Snakemake/config/config.yaml"
res_config = yaml.load(open("/n/home_rc/afreedman/workspace/GenomeAnnotation/Snakemake/config/resources.yaml"),Loader=yaml.FullLoader)
SAMPLES = list(set([basename(i.split('/')[-1].split('_')[0]) for i in glob("_1.fq.gz" % config["fastqDir"])]))
print(SAMPLES)
system("rm %s/gtflist.txt" % ScallopHisat2Dir)
system("rm %s/gtflist.txt" % ScallopStarDir)

for sample in SAMPLES:
   system("echo %s%s_scallop-hisat2.gtf >> gtflist.txt" % (config["ScallopHisat2AssemblyDir"],sample))
   system("echo %s%s_scallop-star.gtf >> gtflist.txt" % (config["ScallopStarAssemblyDir"],sample))

### RULES ###

rule all:
    input:
        "%smytask.scallop.hisat2.done" % ScallopHisat2Dir
        "%smytask.scallop.star.done" % ScallopStarDir
        config["StringtieStarMergeDir"] + config["speciesname"] + "_stringtie-star_merge.gtf"
        config["StringtieHisat2MergeDir"] + config["speciesname"] + "_stringtie-hisat2_merge.gtf" 

include: "workflow/rules/rnaseq.smk"	
